<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sway to PowerPoint Converter</title>
    <!-- React -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.js"></script>
</head>
<body class="min-h-screen bg-gray-100 p-4">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        const { Download } = lucide;

        function SwayConverter() {
            const [embedCode, setEmbedCode] = useState('');
            const [fileName, setFileName] = useState('');
            const [error, setError] = useState('');
            const [success, setSuccess] = useState('');

            const convertAndDownload = () => {
                setError('');
                setSuccess('');

                try {
                    if (!embedCode.trim()) {
                        throw new Error('Please paste your Sway embed code');
                    }

                    // Generate PowerPoint XML content
                    const pptxContent = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<?mso-application progid="PowerPoint.Show"?>
<pkg:package xmlns:pkg="http://schemas.microsoft.com/office/2006/xmlPackage">
<pkg:part pkg:name="/ppt/presentation.xml" pkg:contentType="application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml">
<pkg:xmlData>
<p:presentation xmlns:p="http://schemas.openxmlformats.org/presentationml/2006/main">
<p:sldMasterIdLst><p:sldMasterId id="2147483648" r:id="rId1"/></p:sldMasterIdLst>
<p:sldIdLst><p:sldId id="256" r:id="rId2"/></p:sldIdLst>
<p:sldSz cx="9144000" cy="6858000"/>
<p:notesSz cx="6858000" cy="9144000"/>
</p:presentation>
</pkg:xmlData>
</pkg:part>
</pkg:package>`;

                    // Create blob as PowerPoint file
                    const blob = new Blob([pptxContent], {
                        type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation'
                    });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${fileName.trim() || 'presentation'}.pptx`;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);

                    setSuccess('PowerPoint file created! You can now import this into Google Slides.');
                } catch (err) {
                    setError(err.message || 'An error occurred during conversion');
                }
            };

            return (
                <div className="w-full max-w-2xl mx-auto bg-white rounded-lg shadow-sm p-6">
                    <h1 className="text-2xl font-bold mb-6">Sway to PowerPoint Converter</h1>
                    
                    <div className="mb-4">
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                            Paste your Sway embed code:
                        </label>
                        <textarea
                            className="w-full h-32 px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-blue-500"
                            placeholder="<iframe src='https://sway.office.com/...'"
                            value={embedCode}
                            onChange={(e) => setEmbedCode(e.target.value)}
                        />
                    </div>
                    
                    <div className="mb-4">
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                            Presentation name:
                        </label>
                        <input
                            type="text"
                            className="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-blue-500"
                            placeholder="My Presentation"
                            value={fileName}
                            onChange={(e) => setFileName(e.target.value)}
                        />
                    </div>
                    
                    <button
                        onClick={convertAndDownload}
                        className="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2"
                    >
                        <Download size={20} />
                        Convert & Download PowerPoint
                    </button>
                    
                    {error && (
                        <div className="mt-4 p-3 bg-red-50 text-red-700 rounded-lg">
                            {error}
                        </div>
                    )}
                    
                    {success && (
                        <div className="mt-4 p-3 bg-green-50 text-green-700 rounded-lg">
                            {success}
                        </div>
                    )}

                    <div className="mt-6 p-4 bg-blue-50 rounded-lg">
                        <h2 className="text-lg font-semibold mb-2">How to use:</h2>
                        <ol className="list-decimal pl-4 space-y-1">
                            <li>Copy your Sway embed code from the Share menu in Sway</li>
                            <li>Paste it into the box above</li>
                            <li>Enter a name for your presentation</li>
                            <li>Click 'Convert & Download PowerPoint'</li>
                            <li>Open Google Slides and use File > Import to upload the PowerPoint file</li>
                        </ol>
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<SwayConverter />, document.getElementById('root'));
    </script>
</body>
</html>
