<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sway to Google Slides Converter</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.5;
            background-color: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 24px;
        }

        .header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e5e5e5;
        }

        .header h1 {
            font-size: 1.5rem;
            color: #333;
        }

        .input-section {
            margin-bottom: 24px;
        }

        .input-types {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .input-type-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background: #e5e5e5;
            transition: all 0.2s;
        }

        .input-type-btn.active {
            background: #3b82f6;
            color: white;
        }

        .input-area {
            margin-top: 16px;
        }

        .file-drop {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 32px;
            text-align: center;
            cursor: pointer;
        }

        .file-drop:hover {
            border-color: #3b82f6;
        }

        textarea {
            width: 100%;
            height: 120px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            resize: vertical;
        }

        .convert-btn, .download-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 4px;
            background: #3b82f6;
            color: white;
            cursor: pointer;
            margin-top: 16px;
            font-size: 1rem;
        }

        .convert-btn:hover, .download-btn:hover {
            background: #2563eb;
        }

        .convert-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .download-btn {
            background: #22c55e;
        }

        .download-btn:hover {
            background: #16a34a;
        }

        .alert {
            padding: 12px;
            border-radius: 4px;
            margin-top: 16px;
        }

        .alert-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #f87171;
        }

        .alert-success {
            background: #dcfce7;
            color: #166534;
            border: 1px solid #86efac;
        }

        .instructions {
            margin-top: 16px;
            padding: 16px;
            background: #f8fafc;
            border-radius: 4px;
        }

        .instructions ol {
            margin-left: 24px;
            margin-top: 8px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                <polyline points="13 2 13 9 20 9"></polyline>
            </svg>
            <h1>Sway to Google Slides Converter</h1>
        </div>

        <div class="input-section">
            <div class="input-types">
                <button class="input-type-btn active" data-type="link">Visual Link</button>
                <button class="input-type-btn" data-type="embed">Embed Code</button>
                <button class="input-type-btn" data-type="file">PDF/Word File</button>
            </div>

            <div class="input-area">
                <div id="textInput">
                    <textarea placeholder="Paste your Sway visual link here..."></textarea>
                </div>
                
                <div id="fileInput" class="hidden">
                    <div class="file-drop">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        <p>Drag and drop your file here, or click to browse</p>
                        <input type="file" accept=".pdf,.docx" style="display: none">
                    </div>
                </div>
            </div>
        </div>

        <button id="convertBtn" class="convert-btn">Convert to PPTX</button>
        
        <div id="errorAlert" class="alert alert-error hidden"></div>
        
        <div id="successSection" class="hidden">
            <div class="alert alert-success">
                Conversion completed! Your presentation is ready to download.
            </div>
            
            <button id="downloadBtn" class="download-btn">
                Download PPTX File
            </button>
            
            <div class="instructions">
                <p>To use in Google Slides:</p>
                <ol>
                    <li>Go to slides.google.com</li>
                    <li>Click "File" â†’ "Import"</li>
                    <li>Upload the downloaded PPTX file</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        let currentInputType = 'link';
        let convertedFile = null;
        
        // Input type switching
        document.querySelectorAll('.input-type-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.input-type-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentInputType = btn.dataset.type;
                
                document.getElementById('textInput').classList.toggle('hidden', currentInputType === 'file');
                document.getElementById('fileInput').classList.toggle('hidden', currentInputType !== 'file');
                
                if (currentInputType !== 'file') {
                    document.querySelector('textarea').placeholder = 
                        `Paste your Sway ${currentInputType === 'link' ? 'visual link' : 'embed code'} here...`;
                }
            });
        });

        // File drop handling
        const fileDropArea = document.querySelector('.file-drop');
        const fileInput = document.querySelector('input[type="file"]');

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            fileDropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        fileDropArea.addEventListener('drop', handleDrop, false);
        fileDropArea.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', handleFileSelect);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            handleFiles(files);
        }

        function handleFiles(files) {
            if (files.length > 0) {
                fileDropArea.querySelector('p').textContent = `Selected: ${files[0].name}`;
            }
        }

        // Conversion handling
        document.getElementById('convertBtn').addEventListener('click', async () => {
            const convertBtn = document.getElementById('convertBtn');
            const errorAlert = document.getElementById('errorAlert');
            const successSection = document.getElementById('successSection');
            
            convertBtn.disabled = true;
            convertBtn.textContent = 'Converting...';
            errorAlert.classList.add('hidden');
            successSection.classList.add('hidden');

            try {
                // Simulate conversion process
                await new Promise(resolve => setTimeout(resolve, 2000));

                // Create a simple PPTX-like structure (this is a simplified example)
                const xmlContent = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
                    <p:presentation xmlns:p="http://schemas.openxmlformats.org/presentationml/2006/main">
                        <p:sldMasterIdLst><p:sldMasterId id="2147483648" r:id="rId1"/></p:sldMasterIdLst>
                        <p:sldIdLst>
                            <p:sld>
                                <p:cSld>
                                    <p:spTree>
                                        <p:sp>
                                            <p:txBody>
                                                <a:p><a:r><a:t>Converted Presentation</a:t></a:r></a:p>
                                            </p:txBody>
                                        </p:sp>
                                    </p:spTree>
                                </p:cSld>
                            </p:sld>
                        </p:sldIdLst>
                    </p:presentation>`;

                convertedFile = new Blob([xmlContent], { 
                    type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation' 
                });
                
                successSection.classList.remove('hidden');
            } catch (err) {
                errorAlert.textContent = err.message || 'Error during conversion';
                errorAlert.classList.remove('hidden');
            } finally {
                convertBtn.disabled = false;
                convertBtn.textContent = 'Convert to PPTX';
            }
        });

        // Download handling
        document.getElementById('downloadBtn').addEventListener('click', () => {
            if (convertedFile) {
                const url = URL.createObjectURL(convertedFile);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'presentation.pptx';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        });
    </script>
</body>
</html>
